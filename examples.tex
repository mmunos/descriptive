 \documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm} 
\usepackage{fullpage}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bm}

\def\dotminus{\mathbin{\ooalign{\hss\raise1ex\hbox{.}\hss\cr
  \mathsurround=0pt$-$}}}

\def\Eone{\#\Sigma_1\textsc{[FO]}}
\def\Etwo{\#\Pi_1\textsc{[FO]-HORN}}
\def\Ethree{\#\Sigma_2\textsc{[FO]-HORN}}
\def\Efour{\#\Pi_2\textsc{[FO]-HORN}}

\def\Truc{\textsc{Struct}[\L]}

\def\A{{\frak A}}
\def\C{{\cal C}}
\def\F{{\cal F}}
\def\L{{\cal L}}
\def\N{\mathbb{N}}
\def\P{\vec{P}}
\def\R{\vec{R}}
\def\S{\vec{S}}
\def\X{\vec{X}}
\def\Y{\vec{Y}}
\def\Z{\vec{Z}}
%% a - arity of \X / arity of assignments \P to \X
%% b - arity of predicates in \S
%% c - arity of auxiliar predicates/variables
\def\c{\vec{c}} %% super auxiliar elements
\def\d{\vec{d}} %% counted elements
\def\e{\vec{e}} %% counted elements
%% f - counting function
%% g - other functions
%% h - other functions
%% i - index
%% j - index
%% k - emergency index / size of tuple
%% l - emergency index / size of tuple
\def\l{\vec{\ell}}
%% m - size of variable tuple
%% n - size of predicate tuple
%% o - not used
%% p - 
%% q - 
%% r - size of \X / \P
\def\s{\vec{s}}
%% t - size of \S
\def\t{\vec{t}}
\def\u{\vec{u}} %% auxiliary variables
\def\v{\vec{v}} %% auxiliary variables
\def\w{\vec{w}} %% auxiliary variables
\def\x{\vec{x}} %% quantified variables
\def\y{\vec{y}} %% auxiliary variables
\def\z{\vec{z}} %% open variables
\def\ep{\vec{o}}
\def\ga{\vec{p}}

\newtheorem{theo}{Theorem}
\newtheorem{lemma}[theo]{Lemma}
\newtheorem{claim}[theo]{Claim}
\newtheorem{coro}[theo]{Corollary}

\title{Some examples in extended logic counting classes}

\begin{document}
\maketitle

\section{{\sc \#3-DNF}}
A function $f:\Truc \to \N$ is in $\Eone$ if there exists an {\sc FO}-extended quantifier-free $\L$-formula $\varphi(\Y,\y)$ such that $f = f_{\varphi(\Y,\y)}$. We will now show that {\sc \#3-DNF} $\in\Eone$.\\

Let $\L = \{S_0,S_1,S_2,S_3,\leq\}$, and $\A = \langle A, S_0^\A, S_1^\A, S_2^\A, S_3^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc 3-DNF} formula $\psi$, where $A$ is the set of variables mentioned in $\psi$, $S_i^\A$ is a ternary relation described as follows, for each $i\in\{0,1,2,3\}$:
\begin{eqnarray*}
S_0^\A &=& \{(a_1,a_2,a_3)\mid (\neg a_1 \wedge \neg a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\psi\},\\
S_1^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge \neg a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\psi\},\\
S_2^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge  a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\psi\},\\
S_3^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge  a_2 \wedge  a_3) \mbox{ appears as a disjunct in }\psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{align*}
\varphi(T) =\ &\exists x \exists y \exists z \,(S_0(x,y,z) \wedge \neg T(x) \wedge \neg T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_1(x,y,z) \wedge T(x) \wedge \neg T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_2(x,y,z) \wedge T(x) \wedge T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_3(x,y,z) \wedge T(x) \wedge T(y) \wedge T(z)).
\end{align*}
It is easily seen that each relation $T$ over $\A$ such that $\A\models\varphi(T)$ represents a valid assignment to the variables in $\psi$, and therefore, $f_{\varphi(T)}$ represents {\sc \#3-DNF}.

\section{{\sc \#3-HORN-SAT}}
A function $f:\Truc \to \N$ is in $\Etwo$ if there exists an {\sc FO}-extended quantifier-free $\L$-formula $\varphi(\x,\Y,\y)$ such that $f = f_{\forall \x\,\varphi(\x,\Y,\y)}$ and any second order variables only appear in Horn clauses. We will now show that {\sc \#3-HORN-SAT} $\in\Etwo$.\\

Let $\L = \{P_1,P_2,P_3,N_1,N_2,N_3,\leq\}$, and $\A = \langle A, P_1^\A,P_2^\A,P_3^\A,N_1^\A,N_2^\A,N_3^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc 3-HORN-SAT} formula $\psi$, where $A$ is the set of variables mentioned in $\psi$, and the relations in $\L$ are interpreted as follows:
\begin{eqnarray*}
P_1^\A &=& \{a\mid a \mbox{ appears as a conjunct in }\psi\},\\
P_2^\A &=& \{(a_1,a_2)\mid (a_1\vee \neg a_2) \mbox{ appears as a conjunct in }\psi\},\\
P_3^\A &=& \{(a_1,a_2,a_3)\mid (a_1\vee \neg a_2\vee \neg a_3) \mbox{ appears as a conjunct in }\psi\},\\
N_1^\A &=& \{a\mid (\neg a) \mbox{ appears as a conjunct in }\psi\},\\
N_2^\A &=& \{(a_1,a_2)\mid (\neg a_1\vee \neg a_2) \mbox{ appears as a conjunct in }\psi\},\\
N_3^\A &=& \{(a_1,a_2,a_3)\mid (\neg a_1\vee \neg a_2\vee \neg a_3) \mbox{ appears as a conjunct in }\psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{align*}
\varphi(T) =\ &\forall x\, (\neg P_1(x) \vee T(x))\,\wedge\\
&\forall x\forall y\, (\neg P_2(x,y) \vee T(x) \vee \neg T(y))\,\wedge\\
&\forall x\forall y\forall z\, (\neg P_3(x,y,z) \vee T(x) \vee \neg T(y) \vee \neg T(z))\,\wedge\\
&\forall x\, (\neg N_1(x) \vee \neg T(x))\,\wedge\\
&\forall x\forall y\, (\neg N_2(x,y) \vee \neg T(x) \vee \neg T(y))\,\wedge\\
&\forall x\forall y\forall z\, (\neg N_3(x,y,z) \vee \neg T(x) \vee \neg T(y) \vee \neg T(z))\,\wedge
\end{align*}

We can easily reorder $\varphi(T)$ as $\forall x \forall y \forall z\,\theta(x,y,z,T)$ where $\theta(x,y,z,T)$ is an {\sc FO}-extended quantifier-free $\L$-formula such that any second order variable only appears in a Horn clause. It is easily seen that each relation $T$ over $\A$ such that $\A\models\forall x \forall y \forall z\,\theta(x,y,z,T)$ represents a valid assignment to the variables in $\psi$, and therefore, $f_{\forall x \forall y \forall z\,\theta(x,y,z,T)}$ represents {\sc \#3-HORN-SAT}.

\section{{\sc \#DNF}}
A function $f:\Truc \to \N$ is in $\Ethree$ if there exists an {\sc FO}-extended quantifier-free $\L$-formula $\varphi(\x^1,\x^2,\Y,\y)$ such that $f = f_{\exists\x^1\forall \x^2\,\varphi(\x^1,\x^2,\Y,\y)}$ and any second order variables only appear in Horn clauses. We will now show that {\sc \#DNF} $\in\Ethree$.

Let $\L = \{P,N,\leq\}$, and $\A = \langle A, P^\A, N^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc DNF} formula $\psi$, where $A$ is the set of variables mentioned in $\psi$, $P$ and $N$ is a binary relations described as follows:
\begin{eqnarray*}
P^\A &=& \{(c,\ell)\mid \ell \mbox{ appears in the $c$-th clause in }\psi\},\\
N^\A &=& \{(c,\ell)\mid \neg \ell \mbox{ appears in the $c$-th clause in }\psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{eqnarray*}
\varphi(T) &=& \exists c \,\Big(\forall \ell_1 (\neg P(c,\ell_1) \vee T(\ell_1)) \wedge \forall \ell_2 (\neg N(c,\ell_2) \vee \neg T(\ell_2))\Big). 
\end{eqnarray*}

We reorder $\varphi(T)$ as $\exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)$ where $\theta(c,\ell_1,\ell_2,T)$ is an {\sc FO}-extended quantifier-free $\L$-formula such that any second order variable only appears in a Horn clause. It is easily seen that each relation $T$ over $\A$ such that $\A\models \exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)$ represents a valid assignment to the variables in $\psi$, and therefore, $f_{\exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)}$ represents {\sc \#DNF}.

\end{document}