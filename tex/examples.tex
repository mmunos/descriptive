\section{Some examples in extended logic counting classes}

\subsection{{\sc \#3-DNF}}
We will now show that {\sc \#3-DNF} $\in\EoneE$.\\

Let $\L = \{S_0,S_1,S_2,S_3,\leq\}$, and $\A = \langle A, S_0^\A, S_1^\A, S_2^\A, S_3^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc 3-DNF} formula $\Psi$, where $A$ is the set of variables mentioned in $\Psi$, $S_i^\A$ is a ternary relation described as follows, for each $i\in\{0,1,2,3\}$:
\begin{eqnarray*}
S_0^\A &=& \{(a_1,a_2,a_3)\mid (\neg a_1 \wedge \neg a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\Psi\},\\
S_1^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge \neg a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\Psi\},\\
S_2^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge  a_2 \wedge \neg a_3) \mbox{ appears as a disjunct in }\Psi\},\\
S_3^\A &=& \{(a_1,a_2,a_3)\mid ( a_1 \wedge  a_2 \wedge  a_3) \mbox{ appears as a disjunct in }\Psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{align*}
\varphi(T) =\ &\exists x \exists y \exists z \,(S_0(x,y,z) \wedge \neg T(x) \wedge \neg T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_1(x,y,z) \wedge T(x) \wedge \neg T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_2(x,y,z) \wedge T(x) \wedge T(y) \wedge \neg T(z))\,\vee \\
&\exists x \exists y \exists z \,(S_3(x,y,z) \wedge T(x) \wedge T(y) \wedge T(z)).
\end{align*}
It is easily seen that each relation $T$ over $\A$ such that $\A\models\varphi(T)$ represents a valid assignment to the variables in $\Psi$, and therefore, $f_{\varphi(T)}$ represents {\sc \#3-DNF}.

\subsection{{\sc \#3-HORN-SAT}}
We will now show that {\sc \#3-HORN-SAT} $\in\EoneU$.\\

Let $\L = \{P_1,P_2,P_3,N_1,N_2,N_3,\leq\}$, and $\A = \langle A, P_1^\A,P_2^\A,P_3^\A,N_1^\A,N_2^\A,N_3^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc 3-HORN-SAT} formula $\Psi$, where $A$ is the set of variables mentioned in $\Psi$, and the relations in $\L$ are interpreted as follows:
\begin{eqnarray*}
P_1^\A &=& \{a\mid a \mbox{ appears as a conjunct in }\Psi\},\\
P_2^\A &=& \{(a_1,a_2)\mid (a_1\vee \neg a_2) \mbox{ appears as a conjunct in }\Psi\},\\
P_3^\A &=& \{(a_1,a_2,a_3)\mid (a_1\vee \neg a_2\vee \neg a_3) \mbox{ appears as a conjunct in }\Psi\},\\
N_1^\A &=& \{a\mid (\neg a) \mbox{ appears as a conjunct in }\Psi\},\\
N_2^\A &=& \{(a_1,a_2)\mid (\neg a_1\vee \neg a_2) \mbox{ appears as a conjunct in }\Psi\},\\
N_3^\A &=& \{(a_1,a_2,a_3)\mid (\neg a_1\vee \neg a_2\vee \neg a_3) \mbox{ appears as a conjunct in }\Psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{align*}
\varphi(T) =\ &\forall x\, (\neg P_1(x) \vee T(x))\,\wedge\\
&\forall x\forall y\, (\neg P_2(x,y) \vee T(x) \vee \neg T(y))\,\wedge\\
&\forall x\forall y\forall z\, (\neg P_3(x,y,z) \vee T(x) \vee \neg T(y) \vee \neg T(z))\,\wedge\\
&\forall x\, (\neg N_1(x) \vee \neg T(x))\,\wedge\\
&\forall x\forall y\, (\neg N_2(x,y) \vee \neg T(x) \vee \neg T(y))\,\wedge\\
&\forall x\forall y\forall z\, (\neg N_3(x,y,z) \vee \neg T(x) \vee \neg T(y) \vee \neg T(z))\,\wedge
\end{align*}

We can easily reorder $\varphi(T)$ as $\forall x \forall y \forall z\,\theta(x,y,z,T)$ where $\theta(x,y,z,T)$ is an {\sc FO}-extended quantifier-free $\L$-formula such that any second order variable only appears in a Horn clause. It is easily seen that each relation $T$ over $\A$ such that $\A\models\forall x \forall y \forall z\,\theta(x,y,z,T)$ represents a valid assignment to the variables in $\Psi$, and therefore, $f_{\forall x \forall y \forall z\,\theta(x,y,z,T)}$ represents {\sc \#3-HORN-SAT}.

\subsection{{\sc \#DNF}}
We will now show that {\sc \#DNF} $\in\EtwoE$.\\

Let $\L = \{P,N,\leq\}$, and $\A = \langle A, P^\A, N^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc DNF} formula $\Psi$ with $n$ variables and $m$ clauses, where $A = \{1\ldots,n+m\}$, $P$ and $N$ is a binary relations described as follows:
\begin{eqnarray*}
P^\A &=& \{(c,\ell)\mid \ell \mbox{ appears in the $c$-th clause of }\Psi\},\\
N^\A &=& \{(c,\ell)\mid \neg \ell \mbox{ appears in the $c$-th clause of }\Psi\}.
\end{eqnarray*}

Now let $T$ be a unary second order variable, and
\begin{eqnarray*}
\varphi(T) &=& \exists c \,\Big(\forall \ell_1 (\neg P(c,\ell_1) \vee T(\ell_1)) \wedge \forall \ell_2 (\neg N(c,\ell_2) \vee \neg T(\ell_2))\Big). 
\end{eqnarray*}

We reorder $\varphi(T)$ as $\exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)$ where $\theta(c,\ell_1,\ell_2,T)$ is an {\sc FO}-extended quantifier-free $\L$-formula such that any second order variable only appears in a Horn clause. It is easily seen that each relation $T$ over $\A$ such that $\A\models \exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)$ represents a valid assignment to the variables in $\Psi$, and therefore, $f_{\exists c \forall \ell_1 \forall \ell_2\, \theta(c,\ell_1,\ell_2,T)}$ represents {\sc \#DNF}.\\

By extension, {\sc \#3-DNF} $\in\EtwoE$.

\subsection{{\sc \#HORN-SAT}}
We will now show that {\sc \#HORN-SAT} $\in\EoneU$.\\

Let $\L = \{P,N,F,\leq\}$, and $\A = \langle A, P^\A, N^\A, F^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc HORN-SAT} formula $\Psi$, where $A$, $P$ and $N$ are defined as in the previous case, and $F$ is defined as
\[
	F = \{ c \mid
		\mbox{all literals in $c$ are negative}
	\}
\]

Now let $T$ be a unary second-order variable, and
\begin{align*}
	\psi(T) &=& \forall c\,[ F(c) \to \exists \ell'(N(c,\ell') \wedge \neg T(\ell'))]
	\,\wedge
	 \forall c \forall \ell\, [\neg F(c)\to(P(c,\ell)\wedge\forall\ell'(N(c,\ell')\to T(\ell')))\to T(\ell)] \\
	 &\equiv& \forall c\,[ \neg F(c) \vee \exists \ell'(N(c,\ell') \wedge \neg T(\ell'))]
	 \,\wedge
	 \forall c \forall \ell\, [ F(c) \vee \neg P(c,\ell) \vee \exists\ell'(N(c,\ell') \wedge \neg T(\ell'))) \vee T(\ell)]
\end{align*}
Let $\neg X(c,\ell')$ be defined as $N(c,\ell')\wedge \neg T(\ell)$. That is,
\begin{eqnarray*}
	&& \forall c \forall \ell'\, [(N(c,\ell') \wedge \neg T(\ell')) \leftrightarrow \neg X(c,\ell')]\\
	&\equiv& \forall c \forall \ell'\,[(\neg N(c,\ell')\vee T(\ell')\vee \neg X(c,\ell'))\wedge (X(c,\ell')\vee \neg T(\ell'))\wedge (X(c,\ell')\vee N(c,\ell'))].
\end{eqnarray*}
Finally, let
\begin{multline*}
	\varphi(T,X) = \forall c \forall \ell'\,[(\neg N(c,\ell')\vee T(\ell')\vee \neg X(c,\ell'))\wedge (X(c,\ell')\vee \neg T(\ell'))\wedge (X(c,\ell')\vee N(c,\ell'))]\,\wedge \\
	\forall c\,[ \neg F(c) \vee \exists \ell'\neg X(c,\ell'))]
	\wedge
	\forall c \forall \ell\, [ F(c) \vee \neg P(c,\ell) \vee \exists\ell'\neg X(c,\ell') \vee T(\ell)].
\end{multline*}
Let $\theta(c,\ell,T,X)$ be such that $\varphi'(T,X) = \forall c \forall \ell\,\theta(c,\ell,T,X)$. Note that $\theta(c,\ell,T,X)$ is an {\sc FO}-extended quantifier-free $\L$-formula such that any second order variable only appears in a Horn clause. First, note that each relation $T$ over $\A$ such that $\A\models \psi(T)$ represents a valid assignment to the variables in $\Psi$, and that in $\theta(c,\ell,T,X)$, $X$ is completely defined by the assignment to $T$. Therefore $f_{\psi(T)}(\A') = f_{\varphi'(T,X)}(\A')$ for each $\A'\in\Truc$, from which we conclude that $f_{\forall c \forall \ell\,\theta(c,\ell,T,X)}$ represents {\sc \#HORN-SAT}. 

\subsection{{\sc \#Disj-HORN-SAT}}
We define the decision problem
\[
	\textsc{Disj-HORN-SAT} = \{\Phi \mid \Phi \mbox{ is a disjunction of Horn formulas and $\Phi$ is satisfiable}\},
\]
and the counting problem {\sc \#Disj-HORN-SAT} as a function that counts all satisfying assignments to a formula $\Phi$ which is a disjunction of Horn formulas. We will now show that {\sc \#Disj-HORN-SAT} $\in\EtwoE$.

Let $\L = \{P,N,F,B,\leq\}$, and $\A = \langle A, P^\A, N^\A, F^\A, B^\A, \leq^\A \rangle$ be an $\L-$structure that represents an instance of a {\sc Disj-HORN-SAT} formula $\Psi$ with $n$ variables, $m$ clauses in total, and $k$ Horn formulas, where $A = \{1,\ldots,n+m+k\}$, $P$, $N$ and $F$ are defined as in the previous case, and $B$ is defined as:
\[
	B = \{ (c,f) \mid 
		\mbox{the clause $c$ is in the Horn formula $f$}
	\}.
\]
Now let $T$ be a unary second order variable, and
\[
	\psi(T) = \exists f\forall c\,(B(c,f)\to \forall\ell\,\theta(c,\ell,T,X)),
\]
where $\theta$ is defined as in the previous case.